import { encodeAbiParameters, parseEther, encodeFunctionData, toBytes, toHex } from "viem";

const EXCUTOR_ABI = [
  {
    anonymous: false,
    inputs: [
      { indexed: true, internalType: "uint256", name: "queueId", type: "uint256" },
      { indexed: false, internalType: "address", name: "actionAddress", type: "address" },
      { indexed: false, internalType: "uint256", name: "currentStep", type: "uint256" },
      { indexed: false, internalType: "uint256", name: "tottalStep", type: "uint256" },
    ],
    name: "Process",
    type: "event",
  },
  { inputs: [], name: "logger", outputs: [{ internalType: "contract UEventLogger", name: "", type: "address" }], stateMutability: "view", type: "function" },
  { inputs: [], name: "registry", outputs: [{ internalType: "contract URegistry", name: "", type: "address" }], stateMutability: "view", type: "function" },
  {
    inputs: [
      { internalType: "uint256", name: "_recipeId", type: "uint256" },
      { internalType: "bytes[]", name: "_params", type: "bytes[]" },
      { internalType: "uint8[][]", name: "_paramMappings", type: "uint8[][]" },
      { internalType: "bytes32", name: "_debt", type: "bytes32" },
    ],
    name: "execute1Tx",
    outputs: [],
    stateMutability: "payable",
    type: "function",
  },
];

export const encode = () => {
  const flashLoanParams = encodeAbiParameters(
    [
      { name: "asset", type: "address", internalType: "address" },
      { name: "amount", type: "uint256", internalType: "uint256" },
      { name: "referralCode", type: "uint16", internalType: "uint16" },
    ],
    ["0xaA8E23Fb1079EA71e0a56F48a2aA51851D8433D0", BigInt(5876672), BigInt(0)]
  );

  console.log(flashLoanParams);

  const callData = encodeFunctionData({
    abi: EXCUTOR_ABI,
    functionName: "execute1Tx",
    args: [
      BigInt(3),
      [
        "0x000000000000000000000000aa8e23fb1079ea71e0a56f48a2aa51851d8433d0000000000000000000000000000000000000000000000000000000000059a0470000000000000000000000000000000000000000000000000000000000000000",
        "0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000059a0470000000000000000000000000000000000000000000000000006651728988000000000000000000000000000fda9c831090eb4e006b54846c435dd333856001e00000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000065b9e8ac0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000aa8e23fb1079ea71e0a56f48a2aa51851d8433d00000000000000000000000007b79995e5f793a07bc00c21412e50ecae098e7f9",
        "0x00000000000000000000000000000000000000000000000000038d7ea4c68000000000000000000000000000fda9c831090eb4e006b54846c435dd333856001e0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000012bac54348c0e635dcac9d5fb99f06f24136c9a000000000000000000000000fda9c831090eb4e006b54846c435dd333856001e",
        "0x000000000000000000000000000000000000000000000000000aa87bee538000000000000000000000000000fda9c831090eb4e006b54846c435dd333856001e0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000012bac54348c0e635dcac9d5fb99f06f24136c9a000000000000000000000000fda9c831090eb4e006b54846c435dd333856001e",
        "0x000000000000000000000000000000000000000000000000000000000059a047000000000000000000000000fda9c831090eb4e006b54846c435dd333856001e0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000012bac54348c0e635dcac9d5fb99f06f24136c9a000000000000000000000000fda9c831090eb4e006b54846c435dd333856001e",
        "0x000000000000000000000000aa8e23fb1079ea71e0a56f48a2aa51851d8433d0000000000000000000000000d95791974acd6031cd81b753c338f29ef602679e000000000000000000000000000000000000000000000000000000000059a047",
      ],
      [
        [0, 0, 0],
        [0, 0, 0, 0, 0],
        [0, 0, 0, 0, 0, 0, 0, 0],
        [2, 0, 0, 0, 0, 0, 0, 0],
        [1, 0, 0, 0, 0, 0, 0, 0],
        [0, 0, 1],
      ],
      "0x0000000000000000000000000000000000000000000000000000000000000000",
    ],
  });

  // console.log(callData);
  console.log(callData);
};

encode();
